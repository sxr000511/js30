<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Type Ahead ğŸ‘€</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <form class="search-form">
      <input type="text" class="search" placeholder="City or State" />
      <ul class="suggestions">
        <li>Filter for a city</li>
        <li>or a state</li>
      </ul>
    </form>
    <script>
      // fetch() å»ºç«‹èµ·è·¨åŸŸå¼‚æ­¥ä¼šè¯
      // å½“ç„¶å®ƒåªæ˜¯ä¸€ä¸ª HTTP å“åº”ï¼Œè€Œä¸æ˜¯çœŸçš„JSONã€‚ä¸ºäº†è·å–JSONçš„å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ json() /blob() etc
      const endpoint =
        "https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json";
      const names = [];
      fetch(endpoint)
        .then(function (response) {
          // console.log(response);
          // responsebodyé‡Œ1000æ¡æ•°æ®
          return response.json();
        })
        .then(function (myJson) {
          //  myjson æ˜¯ä¸€ä¸ªobject ï¼Œ1000ä¸ªarrayç»„æˆ
          // es6æ‰©å±•å­—ç¬¦ä¸² å¯¹è±¡çš„åˆå¹¶
          // ...myjsonè¢«æ·»åŠ åˆ°namesæ•°ç»„é‡Œ
          // console.log(myJson[0]);
          names.push(...myJson);
          // console.log(names[0]);
          // è¿™å„¿æ˜¯æ·±æ‹·è´ï¼Œè·å¾—myjsonä¸ºå¯¹è±¡æ•°ç»„ï¼Œæ·±æ‹·è´åˆ°namesé‡Œï¼Œ
          // namesé‡Œå­˜çš„æ˜¯ç´¢å¼•ï¼Œæ‰€ä»¥å¤–éƒ¨å£°æ˜constï¼Œå¯ä»¥ç»™nameså¹…å€¼
          // å¦‚æœåœ¨æ­¤å¤„æ›´æ”¹names[0]ï¼Œä¼šå‘ç°names[0]å’Œmyjson[0]ä¸åŒ
        });

      var input = document.querySelector("input");
      var sug = document.querySelector(".suggestions");

      input.addEventListener("change", inputhandler);
      function inputhandler(event) {
        // this.valueè·å¾—è¾“å…¥å€¼
        // console.log(this.value);
        reghandler(this.value);
      }
      function reghandler(text) {
        // å…¨å±€ä¸åˆ†å¤§å°å†™
        const regex = new RegExp(text, "gi");
        // regresultåŒ…å«æ­£åˆ™åŒ¹é…cityname å’Œ statenameçš„ç»“æœ
        var regresult = names.filter(
          (item) => regex.test(item.city) || regex.test(item.state)
        );
        // console.log(regresult);
        // åŸå¸‚åå­—å¹…å€¼è¿›æ¥
        sug.innerHTML = regresult
          .map((item) => `<li>${item.city} , ${item.state}</li>`)
          .join(" ");
      }
    </script>
  </body>
</html>
